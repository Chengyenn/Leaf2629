<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaf2629 Cat-house</title>
    <link rel="stylesheet" href="css/style2.css">
    <link rel="icon" href="img/圓.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <script src="https://kit.fontawesome.com/1a52dd44d7.js" crossorigin="anonymous"></script>
    <!-- Firebase App is always required and must be first -->
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>

    <!-- Add additional services that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-storage-compat.js"></script>
</head>
<header>
    <nav class="navBar">
        <div class="logo">
            <a href="index.html"><img src="img/logo.png" class="leafLogo"></a>
        </div>
        <div class="nav__menu" id="menu__button">
            <div class="bar1"></div>
            <div class="bar2"></div>
            <div class="bar3"></div>
        </div>
        <!-- <span class="nav__menu">&#9776</span> -->
        <ul class="navItem">
            <li class="navLink">
                <a class="nava" href="#">特價商品</a>
            </li>
            <li class="navLink">
                <a class="nava" href="#">熱賣商品</a>
            </li>
            <li class="navLink1">
                <a class="nava1" href="#">所有商品</a>
                <ul class="nav-sublist">
                    <li class="navLinkblank"><a href="#" class="nava" id="nav-sublista"></a></li>
                    <li class="navLink2"><a href="#" class="nava" id="nav-sublista">上身系列</a></li>
                    <li class="navLink2"><a href="#" class="nava" id="nav-sublista">下身系列</a></li>
                    <li class="navLink2"><a href="#" class="nava" id="nav-sublista">飾品配件</a></li>
                </ul>
            </li>
        </ul>
        <div class="navIcon">
            <div class="car">
                <a href=""><i class="fa-solid fa-cart-shopping fa-lg"></i></a>
            </div>
            <div class="member">
                <a class="memberLink" href="index3.html"><i class="fa-solid fa-circle-user fa-lg"></i></a>
            </div>
        </div>
    </nav>
    <div class="nav_page">
        <!--遮罩-->
        <div class="navham menu-click overlay" id="toright">
            <!-- <a href="javascript:void(0)" id="closelay">&times;</a> -->
            <ul class="navHamItem">
                <li class="navLink">
                    <a class="nava" href="#">特價商品</a>
                </li>
                <li class="navLink">
                    <a class="nava" href="#">熱賣商品</a>
                </li>
                <li class="navLink1">
                    <a class="nava1" href="#">所有商品</a>
                    <ul class="nav-sublist">
                        <li class="navLinkblank"><a href="#" class="nava" id="nav-sublista"></a></li>
                        <li class="navLink2"><a href="#" class="nava" id="nav-sublista">上身系列</a></li>
                        <li class="navLink2"><a href="#" class="nava" id="nav-sublista">下身系列</a></li>
                        <li class="navLink2"><a href="#" class="nava" id="nav-sublista">飾品配件</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</header>

<body>
    <div class="first">
        <div class="picture">
            <img src="img/圖1.png" class="clothes" id="clothes">
            <img src="img/圖1藍.png" class="clothes" id="clothesBlue">
            <img src="img/圖1米.png" class="clothes" id="clothesCream">
        </div>
        <div class="intro">
            <div class="innerbox">
                <p class="title">一起去跑步的朋朋＿坦克背心</p>
                <p class="price">NT$ 790</p>
                <ul class="promotion">
                    <li class="act">・單件9折/兩件85折/三件7折</li>
                    <li class="act">・滿＄1500免運</li>
                    <li class="act">・分享活動現折＄50</li>
                </ul>
                <div class="famount">
                    <button id="size" class="famountButton famountp">F</button>
                    <div class="quantity">
                        <button class="quantityButton quantity_minus"><i
                                class="fa-sharp fa-solid fa-minus "></i></button>
                        <input class="quantity_number" type="text" value="1">
                        <button class="quantityButton quantity_plus"><i class="fa-sharp fa-solid fa-plus "></i></button>
                    </div>
                </div>
                <div class="colorChoose">
                    <button class="colorButton" id="colorButton1" value="寶藍">
                        <div class="color1"></div>
                    </button>
                    <button class="colorButton" id="colorButton2" value="米白">
                        <div class="color2"></div>
                    </button>
                    <button class="colorButton" id="colorButton3" value="淺灰">
                        <div class="color3"></div>
                    </button>
                </div>
                <button class="addcar">加入購物車</button></a>
                <div class="box">
                    <p class="boxp">產品介紹</p>
                    <button class="boxButton" id="productMore">+</button>
                </div>
                <hr>
                <div class="box">
                    <p class="boxp">尺寸表</p>
                    <button class="boxButton" id="sizeMore">+</button>
                </div>
                <hr>
                <div class="box">
                    <p class="boxp">試穿指南</p>
                    <button class="boxButton" id="sizeguideMore">+</button>
                </div>
                <hr>
            </div>
        </div>
        <div class="card_product_page">
            <!--遮罩-->
            <div class="card_product">
                <!--產品介紹-->
                <i class="fa-solid fa-square-xmark productCross"></i>
                <div class="cardText">
                    <div class="material">
                        <p class="cardTitle">材質</p>
                        <hr class="cardhr">
                        <ul>
                            <li class="cardli">・棉 70%</li>
                            <li class="cardli">・亞麻 30%</li>
                        </ul>
                    </div>
                    <div class="description">
                        <p class="cardTitle">商品介紹</p>
                        <hr class="cardhr">
                        <ul>
                            <li class="cardli">・Made In Korea</li>
                        </ul>
                        <p class="descriptionp">沒有挖太多的坦克背心，害羞且遲遲不敢嘗試背心穿搭的，這款可以放入購物車囉！<br>激推與尼龍褲包套，外面搭個氣泡水襯衫，隨便時髦。</p>
                    </div>
                </div>
            </div>
            <div class="card_size">
                <!--尺寸表-->
                <i class="fa-solid fa-square-xmark sizeCross"></i>
                <div class="cardText">
                    <div class="size">
                        <p class="cardTitle">尺寸表</p>
                        <hr class="cardhr">
                        <table>
                            <tr>
                                <td class="sizeTitle">尺寸</td>
                                <td class="sizeTitle">肩寬</td>
                                <td class="sizeTitle">胸寬</td>
                                <td class="sizeTitle">腰寬</td>
                                <td class="sizeTitle">全長</td>
                            </tr>
                        </table>
                        <hr class="sizehr">
                        <table>
                            <tr>
                                <td class="sizeContent">&nbsp;F&nbsp;</td>
                                <td class="sizeContent">28cm</td>
                                <td class="sizeContent">33cm</td>
                                <td class="sizeContent">30cm</td>
                                <td class="sizeContent">45cm</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            <div class="card_sizeguide">
                <!--試穿指南-->
                <i class="fa-solid fa-square-xmark sizeguideCross"></i>
                <div class="cardText">
                    <div class="sizeguide">
                        <p class="cardTitle">試穿指南</p>
                        <hr class="cardhr">
                        <table>
                            <tr>
                                <td class="sizeguideTitle">小編資訊<br>(Female)</td>
                                <td class="sizeguideTitle">身高</td>
                                <td class="sizeguideTitle">體重</td>
                                <td class="sizeguideTitle">肩寬</td>
                                <td class="sizeguideTitle">胸圍</td>
                                <td class="sizeguideTitle">身形特點</td>
                                <td class="sizeguideTitle">尺寸</td>
                                <td class="sizeguideTitle">穿著感</td>
                            </tr>
                        </table>
                        <hr class="sizeguidehr">
                        <table>
                            <tr>
                                <td class="sizeguideContent">A</td>
                                <td class="sizeguideContent">156cm</td>
                                <td class="sizeguideContent">43kg</td>
                                <td class="sizeguideContent">36cm</td>
                                <td class="sizeguideContent">79cm</td>
                                <td class="sizeguideContent">有小腹</td>
                                <td class="sizeguideContent">F</td>
                                <td class="sizeguideContent">寬鬆</td>
                            </tr>
                            <tr>
                                <td class="sizeguideContent">B</td>
                                <td class="sizeguideContent">160cm</td>
                                <td class="sizeguideContent">48kg</td>
                                <td class="sizeguideContent">38cm</td>
                                <td class="sizeguideContent">82cm</td>
                                <td class="sizeguideContent">肩膀偏寬</td>
                                <td class="sizeguideContent">F</td>
                                <td class="sizeguideContent">舒適</td>
                            </tr>
                            <tr>
                                <td class="sizeguideContent">C</td>
                                <td class="sizeguideContent">165cm</td>
                                <td class="sizeguideContent">52kg</td>
                                <td class="sizeguideContent">38cm</td>
                                <td class="sizeguideContent">87cm</td>
                                <td class="sizeguideContent">扁身</td>
                                <td class="sizeguideContent">F</td>
                                <td class="sizeguideContent">舒適</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <footer>
        <div class="footer">
            <div class="footerText">
                <ul class="box1">
                    <li class="footerLink">
                        <a class=footera href="">最新消息</a>
                    </li>
                    <li class="footerLink">
                        <a class=footera href="">常見問題</a>
                    </li>
                    <li class="footerLink">
                        <a class=footera href="">聯絡我們</a>
                    </li>
                </ul>
                <div class="box2">
                    <p class=footerp>Copyright © Leaf2629 Cat-house</p>
                </div>
            </div>
            <div class="footerIcon">
                <a class=icona href=""><i class="fa-brands fa-line fa-2x"></i></a>
                <a class=icona href=""><i class="fa-brands fa-instagram fa-2x"></i></a>
            </div>
            <div class="box2xs">
                <p>Copyright © Leaf2629 Cat-house</p>
            </div>
        </div>
    </footer>

    <!-- script -->

    <!--載入jQuery-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <!--載入jQuery UI 1.11.4-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

    <script>
        $(document).ready(function () {

            $(".card_product_page").hide();
            $(".card_product").hide();
            $(".card_size").hide();
            $(".card_sizeguide").hide();
            $("#clothesBlue").hide();
            $("#clothesCream").hide();

            // 尺寸選擇CSS變化
            $(".famountButton").click(function () {
                $(".famountButton").css("border-color", "#48685A");
            })

            // 數量減少
            $(".quantity_minus").click(function () {
                quantityMinus();
            })

            function quantityMinus() {
                let inputNum = $(".quantity_number").val();
                if (inputNum > 1) {
                    $(".quantity_number").val(--inputNum);
                }
                if (inputNum <= 1) {
                    $(".quantity_number").val("1");
                }
            }

            // 數量增加
            $(".quantity_plus").click(function () {
                quantityPlus();
            })

            function quantityPlus() {
                let inputNum = $(".quantity_number").val();
                $(".quantity_number").val(++inputNum);
            }

            // 顏色選擇CSS變化
            $("#colorButton1").click(function () {
                $("#colorButton1").css("border-color", "#48685A");
                $("#colorButton2").css("border-color", "#ced4da");
                $("#colorButton3").css("border-color", "#ced4da");
                $("#clothesBlue").show();
                $("#clothes").hide();
                $("#clothesCream").hide();
            })

            $("#colorButton2").click(function () {
                $("#colorButton2").css("border-color", "#48685A");
                $("#colorButton1").css("border-color", "#ced4da");
                $("#colorButton3").css("border-color", "#ced4da");
                $("#clothesCream").show();
                $("#clothesBlue").hide();
                $("#clothes").hide();
            })

            $("#colorButton3").click(function () {
                $("#colorButton3").css("border-color", "#48685A");
                $("#colorButton1").css("border-color", "#ced4da");
                $("#colorButton2").css("border-color", "#ced4da");
                $("#clothes").show();
                $("#clothesCream").hide();
                $("#clothesBlue").hide();
            })

            // 加入購物車CSS變化
            $(".addcar").mouseenter(function () {
                $(".addcar").css("background-color", "#48685A");
                $(".addcar").css("cursor", "pointer");
            })

            $(".addcar").mouseleave(function () {
                $(".addcar").css("background-color", "#83978E");
            })

            // 產品介紹展開與收合
            $("#productMore").click(function () {
                $(".card_product_page").toggle();
                $(".card_product_page").css({
                    "background-color": "rgba(0, 0, 0, 0.3);"
                });
                $(".card_product").toggle();
            })

            $(".productCross").click(function () {
                $(".card_product_page").css({
                    "background-color": "transparent"
                });
                $(".card_product_page").toggle();
                $(".card_product").toggle();
            })

            // 尺寸表展開與收合
            $("#sizeMore").click(function () {
                $(".card_product_page").toggle();
                $(".card_product_page").css({
                    "background-color": "rgba(0, 0, 0, 0.3);"
                });
                $(".card_size").toggle();
            })

            $(".sizeCross").click(function () {
                $(".card_product_page").css({
                    "background-color": "transparent"
                });
                $(".card_product_page").toggle();
                $(".card_size").toggle();
            })

            // 試穿指南開與收合
            $("#sizeguideMore").click(function () {
                $(".card_product_page").toggle();
                $(".card_product_page").css({
                    "background-color": "rgba(0, 0, 0, 0.3);"
                });
                $(".card_sizeguide").toggle();
            })

            $(".sizeguideCross").click(function () {
                $(".card_product_page").css({
                    "background-color": "transparent"
                });
                $(".card_product_page").toggle();
                $(".card_sizeguide").toggle();
            })

            // Initialize Firebase
            firebase.initializeApp({
                apiKey: "AIzaSyBMJUebx1GMqfdCA-XaP35oyKGH-AgiV2U",
                authDomain: "finalproject-b039c.firebaseapp.com",
                projectId: "finalproject-b039c",
                storageBucket: "finalproject-b039c.appspot.com",
                messagingSenderId: "501590789422",
                appId: "1:501590789422:web:0c6e94aaef920e7891bebf"
            });
            // Reference Firebase Auth
            const auth = firebase.auth();

            // 購物車連結          
            let db = firebase.firestore();
            let shoppingCartRef = db.collection("shoppingCart");
            let userEmail;
            let chooseColor;

            // Listening Login User
            auth.onAuthStateChanged(function (user) {
                if (user) {
                    console.log(user);
                    user.providerData.forEach(function (profile) {
                        userEmail = profile.email;
                    });
                    $(".memberLink").attr("href", "index6.html");
                } else {
                    console.log("not logged in");
                    $(".memberLink").attr("href", "index3.html");
                }
            });

            $(".addcar").click(function () {
                $(".addcar").css("background-color", "#83978E");
                if (!userEmail) {
                    alert("請先登入！");
                    window.location.href = "./index3.html"
                }
                let docRef = shoppingCartRef.doc(userEmail);

                // 傳至後台
                docRef.set({
                    "goodsTitle": $(".title").html(), 
                    "goodsPrice": $(".price").html().toString().substr(4), 
                    "goodsSize": $("#size").html(),
                    "goodsColor": chooseColor,
                    "goodsQuantity": $(".quantity_number").val()
                });

                // 導頁至購物車頁面
                window.location.href = "./index7.html"
            })

            // color事件
            $("#colorButton1").click(function(){
                chooseColor = $("#colorButton1").val();
            })

            $("#colorButton2").click(function(){
                chooseColor = $("#colorButton2").val();
            })

            $("#colorButton3").click(function(){
                chooseColor = $("#colorButton3").val();
            })

            //漢堡選單
            $(".nav_page").hide();

            let $ul = $(".navham"),
                $menu = $(".nav__menu");

            $($menu).click(function () {
                $(".nav_page").toggle();
                $(".nav_page").css({
                    "background-color": "rgba(0, 0, 0, 0.3);"
                });
                $ul.toggle("menu-click");
            })

        })
        let btn = document.getElementById("menu__button");
        btn.addEventListener("click", openlay, false);
        let closelays = document.getElementById("closelay");
        closelays.addEventListener("click", closelay, false);

        function openlay() {
            this.classList.toggle("change");
            document.getElementById("toright").style.width = "40%";
        }

        function closelay() {
            document.getElementById("toright").style.width = "0%";
        }
    </script>

</body>

</html>